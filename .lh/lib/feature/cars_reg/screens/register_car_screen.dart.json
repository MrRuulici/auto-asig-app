{
    "sourceFile": "lib/feature/cars_reg/screens/register_car_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1728039238056,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1728039272896,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,11 +100,17 @@\n       ),\r\n       bottomNavigationBar: Padding(\r\n         padding: const EdgeInsets.all(padding),\r\n         child: ElevatedButton(\r\n-          onPressed: () {\r\n-            context.read<CarInfoCubit>().addCar();\r\n+          onPressed: () async {\r\n+            try{\r\n+            await context.read<CarInfoCubit>().addCar();} catch(e){\r\n+              print(e);\r\n+              \r\n             Navigator.of(context).pop();\r\n+            }\r\n+\r\n+\r\n           },\r\n           child: const Text('Înregistrează vehicul'),\r\n         ),\r\n       ),\r\n"
                },
                {
                    "date": 1728039312361,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,4 +1,5 @@\n+import 'package:auto_asig/core/data/assistants.dart';\r\n import 'package:auto_asig/core/data/constants.dart';\r\n import 'package:auto_asig/core/widgets/date_picker_field.dart';\r\n import 'package:auto_asig/feature/cars_reg/cubit/car_info_cubit.dart';\r\n import 'package:auto_asig/feature/home_screen/screens/home_screen.dart';\r\n@@ -101,14 +102,27 @@\n       bottomNavigationBar: Padding(\r\n         padding: const EdgeInsets.all(padding),\r\n         child: ElevatedButton(\r\n           onPressed: () async {\r\n+            // show loading dialog\r\n+            showDialog(\r\n+              context: context,\r\n+              builder: (context) {\r\n+                return const Center(\r\n+                  child: CircularProgressIndicator(),\r\n+                );\r\n+              },\r\n+            );\r\n+\r\n             try {\r\n               await context.read<CarInfoCubit>().addCar();\r\n+\r\n+              Navigator.of(context).pop();\r\n             } catch (e) {\r\n               print(e);\r\n \r\n               Navigator.of(context).pop();\r\n+              showSnackbar(context, 'A apărut o eroare. Te rugăm să încerci din nou.');\r\n             }\r\n           },\r\n           child: const Text('Înregistrează vehicul'),\r\n         ),\r\n"
                },
                {
                    "date": 1728287096134,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,12 @@\n+import 'package:auto_asig/core/cubit/user_data_cubit.dart';\r\n import 'package:auto_asig/core/data/assistants.dart';\r\n import 'package:auto_asig/core/data/constants.dart';\r\n+import 'package:auto_asig/core/models/car_info.dart';\r\n import 'package:auto_asig/core/widgets/date_picker_field.dart';\r\n import 'package:auto_asig/feature/cars_reg/cubit/car_info_cubit.dart';\r\n import 'package:auto_asig/feature/home_screen/screens/home_screen.dart';\r\n+import 'package:firebase_auth/firebase_auth.dart';\r\n import 'package:flutter/material.dart';\r\n import 'package:flutter_bloc/flutter_bloc.dart';\r\n \r\n class RegisterCarScreen extends StatelessWidget {\r\n@@ -115,8 +118,18 @@\n \r\n             try {\r\n               await context.read<CarInfoCubit>().addCar();\r\n \r\n+\r\n+              // context.read<UserDataCubit>().addCar(CarInfo(\r\n+              //       carNumber: nrCar.text,\r\n+              //       expirationDateRCA: carInfo.expirationDateRCA,\r\n+              //       expirationDateITP: carInfo.expirationDateITP,\r\n+              //       expirationDateCASCO: carInfo.expirationDateCASCO,\r\n+              //       expirationDateRovinieta: carInfo.expirationDateRovinieta,\r\n+              //       expirationDateTahograf: carInfo.expirationDateTahograf,\r\n+              //     ));\r\n+\r\n               Navigator.of(context).pop();\r\n             } catch (e) {\r\n               print(e);\r\n \r\n"
                }
            ],
            "date": 1728039238056,
            "name": "Commit-0",
            "content": "import 'package:auto_asig/core/data/constants.dart';\r\nimport 'package:auto_asig/core/widgets/date_picker_field.dart';\r\nimport 'package:auto_asig/feature/cars_reg/cubit/car_info_cubit.dart';\r\nimport 'package:auto_asig/feature/home_screen/screens/home_screen.dart';\r\nimport 'package:flutter/material.dart';\r\nimport 'package:flutter_bloc/flutter_bloc.dart';\r\n\r\nclass RegisterCarScreen extends StatelessWidget {\r\n  const RegisterCarScreen({super.key});\r\n\r\n  static const path = 'register_car';\r\n  static const absolutePath = '${HomeScreen.path}/$path';\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    TextEditingController nrCar = TextEditingController();\r\n\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        title: const Text('Înregistrare vehicul'),\r\n      ),\r\n      body: BlocProvider(\r\n        create: (_) => CarInfoCubit(),\r\n        child: BlocBuilder<CarInfoCubit, CarInfoState>(\r\n          builder: (context, carInfo) {\r\n            return Padding(\r\n              padding: const EdgeInsets.symmetric(horizontal: padding),\r\n              child: SingleChildScrollView(\r\n                child: Column(\r\n                  crossAxisAlignment: CrossAxisAlignment.center,\r\n                  children: [\r\n                    const Text(\r\n                        'Te rugăm să introduci datele vehiculului pentru a-l înregistra:'),\r\n                    const SizedBox(height: 20),\r\n                    TextField(\r\n                      textCapitalization: TextCapitalization.characters,\r\n                      controller: nrCar,\r\n                      decoration: const InputDecoration(\r\n                        labelText: 'Număr de înmatriculare',\r\n                      ),\r\n                      onChanged: (value) {\r\n                        context.read<CarInfoCubit>().updateCarNumber(value);\r\n                      },\r\n                    ),\r\n                    const SizedBox(height: 20),\r\n                    DatePickerField(\r\n                      label: \"Data expirare ITP\",\r\n                      selectedDate: carInfo.expirationDateITP,\r\n                      onDateSelected: (date) {\r\n                        context\r\n                            .read<CarInfoCubit>()\r\n                            .updateExpirationDateITP(date);\r\n                      },\r\n                    ),\r\n                    const SizedBox(height: 20),\r\n                    DatePickerField(\r\n                      label: \"Data expirare RCA\",\r\n                      selectedDate: carInfo.expirationDateRCA,\r\n                      onDateSelected: (date) {\r\n                        context\r\n                            .read<CarInfoCubit>()\r\n                            .updateExpirationDateRCA(date);\r\n                      },\r\n                    ),\r\n                    const SizedBox(height: 20),\r\n                    DatePickerField(\r\n                      label: \"Data expirare CASCO\",\r\n                      selectedDate: carInfo.expirationDateCASCO,\r\n                      onDateSelected: (date) {\r\n                        context\r\n                            .read<CarInfoCubit>()\r\n                            .updateExpirationDateCASCO(date);\r\n                      },\r\n                    ),\r\n                    const SizedBox(height: 20),\r\n                    DatePickerField(\r\n                      label: \"Data expirare Rovinieta\",\r\n                      selectedDate: carInfo.expirationDateRovinieta,\r\n                      onDateSelected: (date) {\r\n                        context\r\n                            .read<CarInfoCubit>()\r\n                            .updateExpirationDateRovinieta(date);\r\n                      },\r\n                    ),\r\n                    DatePickerField(\r\n                      label: \"Data expirare Tahograf\",\r\n                      selectedDate: carInfo.expirationDateTahograf,\r\n                      onDateSelected: (date) {\r\n                        context\r\n                            .read<CarInfoCubit>()\r\n                            .updateExpirationDateTahograf(date);\r\n                      },\r\n                    ),\r\n                  ],\r\n                ),\r\n              ),\r\n            );\r\n          },\r\n        ),\r\n      ),\r\n      bottomNavigationBar: Padding(\r\n        padding: const EdgeInsets.all(padding),\r\n        child: ElevatedButton(\r\n          onPressed: () {\r\n            context.read<CarInfoCubit>().addCar();\r\n            Navigator.of(context).pop();\r\n          },\r\n          child: const Text('Înregistrează vehicul'),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n}\r\n"
        }
    ]
}